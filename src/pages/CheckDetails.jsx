import {useNavigate} from 'react-router-dom';
import {useForm} from '../context/FormContext.jsx';
import Header from '../components/Header.jsx';
import {calculateEndDate, formatDateForDisplay} from './VehicleDetails.jsx';

function CheckDetails() {
    const navigate = useNavigate();
    const { state } = useForm();
  console.log(state)
  
    // Форматирование даты
    const formatDateDisplay = (dateString) => {
      const date = new Date(dateString);
      return date.toLocaleDateString('en-GB', { 
        day: '2-digit',
        month: '2-digit',
        year: 'numeric'
      }).replace(/\//g, '-');
    };
  
    // Проверка наличия данных
    if (!state.plateNumber || !state.startDate) {
      navigate('/vehicle');
      return null;
    }
  
    return (
      <div className="w-full h-screen flex flex-col items-center">
        <Header progress={90} />

        <div>

          <h2 style={{
            marginTop: '60px',
            marginBottom: '16px'
          }} className="text-[20px] font-medium leading-[30px] font-poppins text-center mb-6">
            Check Details
          </h2>

          <svg width="271" height="40" viewBox="0 0 271 40" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M18.5 16.6665H42.5V23.3332H18.5V16.6665Z" fill="#EEEEEE"/>
            <path
              d="M39.8333 11.3335H21.1667C20.4594 11.3335 19.7811 11.6144 19.281 12.1145C18.781 12.6146 18.5 13.2929 18.5 14.0002V16.6668H42.5V14.0002C42.5 13.2929 42.219 12.6146 41.719 12.1145C41.2189 11.6144 40.5406 11.3335 39.8333 11.3335ZM21.1667 28.6668H39.8333C40.5406 28.6668 41.2189 28.3859 41.719 27.8858C42.219 27.3857 42.5 26.7074 42.5 26.0002V23.3335H18.5V26.0002C18.5 26.7074 18.781 27.3857 19.281 27.8858C19.7811 28.3859 20.4594 28.6668 21.1667 28.6668Z"
              fill="#ED2939"/>
            <path
              d="M57.7602 24.574H51.6442L50.6322 27.5H47.3982L52.9202 12.122H56.5062L62.0282 27.5H58.7722L57.7602 24.574ZM56.9242 22.11L54.7022 15.686L52.4802 22.11H56.9242ZM75.5982 15.312V27.5H72.4962V25.96C72.1002 26.488 71.5796 26.906 70.9342 27.214C70.3036 27.5073 69.6142 27.654 68.8662 27.654C67.9129 27.654 67.0696 27.456 66.3362 27.06C65.6029 26.6493 65.0236 26.0553 64.5982 25.278C64.1876 24.486 63.9822 23.5473 63.9822 22.462V15.312H67.0622V22.022C67.0622 22.99 67.3042 23.738 67.7882 24.266C68.2722 24.7793 68.9322 25.036 69.7682 25.036C70.6189 25.036 71.2862 24.7793 71.7702 24.266C72.2542 23.738 72.4962 22.99 72.4962 22.022V15.312H75.5982ZM83.3011 27.698C82.3038 27.698 81.4091 27.522 80.6171 27.17C79.8251 26.8033 79.1945 26.312 78.7251 25.696C78.2705 25.08 78.0211 24.398 77.9771 23.65H81.0791C81.1378 24.1193 81.3651 24.508 81.7611 24.816C82.1718 25.124 82.6778 25.278 83.2791 25.278C83.8658 25.278 84.3205 25.1607 84.6431 24.926C84.9805 24.6913 85.1491 24.3907 85.1491 24.024C85.1491 23.628 84.9438 23.3347 84.5331 23.144C84.1371 22.9387 83.4991 22.7187 82.6191 22.484C81.7098 22.264 80.9618 22.0367 80.3751 21.802C79.8031 21.5673 79.3045 21.208 78.8791 20.724C78.4685 20.24 78.2631 19.5873 78.2631 18.766C78.2631 18.0913 78.4538 17.4753 78.8351 16.918C79.2311 16.3607 79.7885 15.9207 80.5071 15.598C81.2405 15.2753 82.0985 15.114 83.0811 15.114C84.5331 15.114 85.6918 15.4807 86.5571 16.214C87.4225 16.9327 87.8991 17.908 87.9871 19.14H85.0391C84.9951 18.656 84.7898 18.2747 84.4231 17.996C84.0711 17.7027 83.5945 17.556 82.9931 17.556C82.4358 17.556 82.0031 17.6587 81.6951 17.864C81.4018 18.0693 81.2551 18.3553 81.2551 18.722C81.2551 19.1327 81.4605 19.448 81.8711 19.668C82.2818 19.8733 82.9198 20.086 83.7851 20.306C84.6651 20.526 85.3911 20.7533 85.9631 20.988C86.5351 21.2227 87.0265 21.5893 87.4371 22.088C87.8625 22.572 88.0825 23.2173 88.0971 24.024C88.0971 24.728 87.8991 25.3587 87.5031 25.916C87.1218 26.4733 86.5645 26.9133 85.8311 27.236C85.1125 27.544 84.2691 27.698 83.3011 27.698ZM94.2114 17.842V23.738C94.2114 24.1487 94.3068 24.4493 94.4974 24.64C94.7028 24.816 95.0401 24.904 95.5094 24.904H96.9394V27.5H95.0034C92.4074 27.5 91.1094 26.2387 91.1094 23.716V17.842H89.6574V15.312H91.1094V12.298H94.2114V15.312H96.9394V17.842H94.2114ZM102.235 17.204C102.631 16.5587 103.144 16.0527 103.775 15.686C104.42 15.3193 105.153 15.136 105.975 15.136V18.37H105.161C104.193 18.37 103.459 18.5973 102.961 19.052C102.477 19.5067 102.235 20.2987 102.235 21.428V27.5H99.1547V15.312H102.235V17.204ZM109.611 13.86C109.069 13.86 108.614 13.6913 108.247 13.354C107.895 13.002 107.719 12.5693 107.719 12.056C107.719 11.5427 107.895 11.1173 108.247 10.78C108.614 10.428 109.069 10.252 109.611 10.252C110.154 10.252 110.601 10.428 110.953 10.78C111.32 11.1173 111.503 11.5427 111.503 12.056C111.503 12.5693 111.32 13.002 110.953 13.354C110.601 13.6913 110.154 13.86 109.611 13.86ZM111.129 15.312V27.5H108.049V15.312H111.129ZM113.38 21.362C113.38 20.13 113.622 19.0373 114.106 18.084C114.605 17.1307 115.272 16.3973 116.108 15.884C116.959 15.3707 117.905 15.114 118.946 15.114C119.856 15.114 120.648 15.2973 121.322 15.664C122.012 16.0307 122.562 16.4927 122.972 17.05V15.312H126.074V27.5H122.972V25.718C122.576 26.29 122.026 26.7667 121.322 27.148C120.633 27.5147 119.834 27.698 118.924 27.698C117.898 27.698 116.959 27.434 116.108 26.906C115.272 26.378 114.605 25.6373 114.106 24.684C113.622 23.716 113.38 22.6087 113.38 21.362ZM122.972 21.406C122.972 20.658 122.826 20.02 122.532 19.492C122.239 18.9493 121.843 18.5387 121.344 18.26C120.846 17.9667 120.31 17.82 119.738 17.82C119.166 17.82 118.638 17.9593 118.154 18.238C117.67 18.5167 117.274 18.9273 116.966 19.47C116.673 19.998 116.526 20.6287 116.526 21.362C116.526 22.0953 116.673 22.7407 116.966 23.298C117.274 23.8407 117.67 24.2587 118.154 24.552C118.653 24.8453 119.181 24.992 119.738 24.992C120.31 24.992 120.846 24.8527 121.344 24.574C121.843 24.2807 122.239 23.87 122.532 23.342C122.826 22.7993 122.972 22.154 122.972 21.406ZM145.655 21.142C145.655 21.582 145.625 21.978 145.567 22.33H136.657C136.73 23.21 137.038 23.8993 137.581 24.398C138.123 24.8967 138.791 25.146 139.583 25.146C140.727 25.146 141.541 24.6547 142.025 23.672H145.347C144.995 24.8453 144.32 25.8133 143.323 26.576C142.325 27.324 141.101 27.698 139.649 27.698C138.475 27.698 137.419 27.4413 136.481 26.928C135.557 26.4 134.831 25.6593 134.303 24.706C133.789 23.7527 133.533 22.6527 133.533 21.406C133.533 20.1447 133.789 19.0373 134.303 18.084C134.816 17.1307 135.535 16.3973 136.459 15.884C137.383 15.3707 138.446 15.114 139.649 15.114C140.807 15.114 141.841 15.3633 142.751 15.862C143.675 16.3607 144.386 17.072 144.885 17.996C145.398 18.9053 145.655 19.954 145.655 21.142ZM142.465 20.262C142.45 19.47 142.164 18.8393 141.607 18.37C141.049 17.886 140.367 17.644 139.561 17.644C138.798 17.644 138.153 17.8787 137.625 18.348C137.111 18.8027 136.796 19.4407 136.679 20.262H142.465ZM157.275 18.348V20.944H147.947V18.348H157.275ZM165.811 24.662L168.891 15.312H172.169L167.659 27.5H163.919L159.431 15.312H162.731L165.811 24.662ZM175.461 13.86C174.918 13.86 174.464 13.6913 174.097 13.354C173.745 13.002 173.569 12.5693 173.569 12.056C173.569 11.5427 173.745 11.1173 174.097 10.78C174.464 10.428 174.918 10.252 175.461 10.252C176.004 10.252 176.451 10.428 176.803 10.78C177.17 11.1173 177.353 11.5427 177.353 12.056C177.353 12.5693 177.17 13.002 176.803 13.354C176.451 13.6913 176.004 13.86 175.461 13.86ZM176.979 15.312V27.5H173.899V15.312H176.979ZM184.796 15.114C185.705 15.114 186.505 15.2973 187.194 15.664C187.883 16.016 188.426 16.478 188.822 17.05V15.312H191.924V27.588C191.924 28.7173 191.697 29.722 191.242 30.602C190.787 31.4967 190.105 32.2007 189.196 32.714C188.287 33.242 187.187 33.506 185.896 33.506C184.165 33.506 182.743 33.1027 181.628 32.296C180.528 31.4893 179.905 30.3893 179.758 28.996H182.816C182.977 29.5533 183.322 29.9933 183.85 30.316C184.393 30.6533 185.045 30.822 185.808 30.822C186.703 30.822 187.429 30.5507 187.986 30.008C188.543 29.48 188.822 28.6733 188.822 27.588V25.696C188.426 26.268 187.876 26.7447 187.172 27.126C186.483 27.5073 185.691 27.698 184.796 27.698C183.769 27.698 182.831 27.434 181.98 26.906C181.129 26.378 180.455 25.6373 179.956 24.684C179.472 23.716 179.23 22.6087 179.23 21.362C179.23 20.13 179.472 19.0373 179.956 18.084C180.455 17.1307 181.122 16.3973 181.958 15.884C182.809 15.3707 183.755 15.114 184.796 15.114ZM188.822 21.406C188.822 20.658 188.675 20.02 188.382 19.492C188.089 18.9493 187.693 18.5387 187.194 18.26C186.695 17.9667 186.16 17.82 185.588 17.82C185.016 17.82 184.488 17.9593 184.004 18.238C183.52 18.5167 183.124 18.9273 182.816 19.47C182.523 19.998 182.376 20.6287 182.376 21.362C182.376 22.0953 182.523 22.7407 182.816 23.298C183.124 23.8407 183.52 24.2587 184.004 24.552C184.503 24.8453 185.031 24.992 185.588 24.992C186.16 24.992 186.695 24.8527 187.194 24.574C187.693 24.2807 188.089 23.87 188.382 23.342C188.675 22.7993 188.822 22.154 188.822 21.406ZM201.686 15.136C203.138 15.136 204.311 15.598 205.206 16.522C206.101 17.4313 206.548 18.7073 206.548 20.35V27.5H203.468V20.768C203.468 19.8 203.226 19.0593 202.742 18.546C202.258 18.018 201.598 17.754 200.762 17.754C199.911 17.754 199.237 18.018 198.738 18.546C198.254 19.0593 198.012 19.8 198.012 20.768V27.5H194.932V15.312H198.012V16.83C198.423 16.302 198.943 15.8913 199.574 15.598C200.219 15.29 200.923 15.136 201.686 15.136ZM220.807 21.142C220.807 21.582 220.778 21.978 220.719 22.33H211.809C211.882 23.21 212.19 23.8993 212.733 24.398C213.276 24.8967 213.943 25.146 214.735 25.146C215.879 25.146 216.693 24.6547 217.177 23.672H220.499C220.147 24.8453 219.472 25.8133 218.475 26.576C217.478 27.324 216.253 27.698 214.801 27.698C213.628 27.698 212.572 27.4413 211.633 26.928C210.709 26.4 209.983 25.6593 209.455 24.706C208.942 23.7527 208.685 22.6527 208.685 21.406C208.685 20.1447 208.942 19.0373 209.455 18.084C209.968 17.1307 210.687 16.3973 211.611 15.884C212.535 15.3707 213.598 15.114 214.801 15.114C215.96 15.114 216.994 15.3633 217.903 15.862C218.827 16.3607 219.538 17.072 220.037 17.996C220.55 18.9053 220.807 19.954 220.807 21.142ZM217.617 20.262C217.602 19.47 217.316 18.8393 216.759 18.37C216.202 17.886 215.52 17.644 214.713 17.644C213.95 17.644 213.305 17.8787 212.777 18.348C212.264 18.8027 211.948 19.4407 211.831 20.262H217.617ZM226.641 17.842V23.738C226.641 24.1487 226.736 24.4493 226.927 24.64C227.132 24.816 227.47 24.904 227.939 24.904H229.369V27.5H227.433C224.837 27.5 223.539 26.2387 223.539 23.716V17.842H222.087V15.312H223.539V12.298H226.641V15.312H229.369V17.842H226.641ZM235.17 17.842V23.738C235.17 24.1487 235.266 24.4493 235.456 24.64C235.662 24.816 235.999 24.904 236.468 24.904H237.898V27.5H235.962C233.366 27.5 232.068 26.2387 232.068 23.716V17.842H230.616V15.312H232.068V12.298H235.17V15.312H237.898V17.842H235.17ZM251.444 21.142C251.444 21.582 251.414 21.978 251.356 22.33H242.446C242.519 23.21 242.827 23.8993 243.37 24.398C243.912 24.8967 244.58 25.146 245.372 25.146C246.516 25.146 247.33 24.6547 247.814 23.672H251.136C250.784 24.8453 250.109 25.8133 249.112 26.576C248.114 27.324 246.89 27.698 245.438 27.698C244.264 27.698 243.208 27.4413 242.27 26.928C241.346 26.4 240.62 25.6593 240.092 24.706C239.578 23.7527 239.322 22.6527 239.322 21.406C239.322 20.1447 239.578 19.0373 240.092 18.084C240.605 17.1307 241.324 16.3973 242.248 15.884C243.172 15.3707 244.235 15.114 245.438 15.114C246.596 15.114 247.63 15.3633 248.54 15.862C249.464 16.3607 250.175 17.072 250.674 17.996C251.187 18.9053 251.444 19.954 251.444 21.142ZM248.254 20.262C248.239 19.47 247.953 18.8393 247.396 18.37C246.838 17.886 246.156 17.644 245.35 17.644C244.587 17.644 243.942 17.8787 243.414 18.348C242.9 18.8027 242.585 19.4407 242.468 20.262H248.254Z"
              fill="#2C2C2C"/>
          </svg>

          <div style={{
            height: '40px',
            padding: '0',
            display: 'flex',
            alignItems: 'center',
            marginTop: '16px',
            borderRadius: '20px'
          }} className="flex gap-2 bg-white rounded-xl p-4 mb-4">

            <span className="flex-1 font-poppins text-[22px] font-semibold leading-[33px] text-center text-[#2C2C2C]">
              {state.plateNumber}
            </span>
          </div>

          <div className="mb-6">
            <p className="text-sm text-gray-500 mb-2">Validity period</p>
            <div className="flex justify-between items-center">
              <div>
                <p className="font-poppins">{formatDateDisplay(state.startDate)}</p>
                <p className="text-xs text-gray-500">00:01</p>
              </div>
              <span className="text-gray-500 mx-2">-</span>
              <div>
                <p
                  className="font-poppins">{formatDateDisplay(calculateEndDate(state.startDate, state.vehiclePeriod))}</p>
                <p className="text-xs text-gray-500">23:59</p>
              </div>
            </div>
          </div>

          <div className="mb-8">
            <p className="text-[26px] font-semibold font-poppins">{state.amount}€ <span
              className="text-sm font-normal">incl.tax</span></p>
          </div>

          <button
            onClick={() => navigate('/payment')}
            className="w-full h-[48px] bg-[#E31E24] text-white rounded-xl font-poppins text-[14px] font-medium"
          >
            Confirm
          </button>

          <button
            onClick={() => navigate(-1)}
            className="w-full text-center text-[#E31E24] mt-4 text-sm font-poppins"
          >
            Something wrong
          </button>
        </div>
      </div>
    );
}

export default CheckDetails;